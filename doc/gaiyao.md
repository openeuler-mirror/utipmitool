---------------------------------------------------------------------------------------------------------- -- -------------- ----------------

  **XXX项目概要设计说明书**                                                                                                    
  ![统信软件logo-专色蓝](pic/media/image2.png){width="3.1506944444444445in" height="1.3173611111111112in"}                     
  **配置项编号**                                                                                                **版本号**     
  **文档密级**                                                                                                  **编制部门**   
  **编制人**                                                                                                    **日期**       XXXX年XX月XX日
  **审核人**                                                                                                    **日期**       XXXX年XX月XX日
  **批准人**                                                                                                    **日期**       XXXX年XX月XX日
---------------------------------------------------------------------------------------------------------- -- -------------- ----------------

修订记录

---------- ------------ ------------------ -------------- ------------ ------------ ------------
  **序号**   **版本号**   **修订内容描述**   **修订日期**   **修订人**   **审核人**   **批准人**
  1          V1.0         创建                                                        
                                                                                      
                                                                                      
                                                                                      
                                                                                      
---------- ------------ ------------------ -------------- ------------ ------------ ------------

目录

1 概述 1

[1.1 目的 1](\l)

[1.2 术语说明 1](\l)

[1.3 参考资料 2](\l)

[1.4 样式说明（正文删除本节） 2](\l)

[2 系统设计 7](\l)

[2.1 设计原则 7](\l)

[2.2 需求分析 7](\l)

[2.3 主要模块设计 7](\l)

[2.3.1 结构设计 7](\l)

[2.3.2 模块A设计 9](\l)

[2.3.3 模块B设计 10](\l)

[2.3.4 模块C设计 10](\l)

[2.4 关键流程设计 10](\l)

[2.5 关键接口设计 12](\l)

[2.6 关键数据结构设计 12](\l)

[2.7 数据库设计 12](\l)

[2.7.1 数据库设计概述 13](\l)

[2.7.2 数据库信息 13](\l)

[2.7.3 数据库ER图设计 13](\l)

[2.7.4 数据库表结构 14](\l)

[2.7.5 表结构约束 15](\l)

[2.7.6 数据库视图 15](\l)

[2.7.7 存储过程 16](\l)

[2.7.8 触发器 16](\l)

[2.7.9 函数 16](\l)

[2.7.10 数据安全 16](\l)

[2.8 主要人机交互设计 16](\l)

[3 非功能性设计 17](\l)

[3.1 安全性 17](\l)

[3.2 性能 18](\l)

[3.3 可靠性 18](\l)

[3.4 易用性 18](\l)

[3.5 可用性 19](\l)

[3.6 兼容性 19](\l)

[3.7 韧性 19](\l)

[3.8 隐私 19](\l)

[3.9 可维护性 20](\l)

[4 部署与实施 20](\l)

[5 专利 22](\l)

[6 附录 22](\l)

[7 变更记录 22](\l)

概述
====

目的
----

本文档是针对XXX系统给出的系统概要设计文档，在本文档中，将给出XXX系统的系统设计原则、关键静态结构设计、关键动态流程设计、数据结构设计、人机交互设计、非功能性设计、系统部署与实施设计、版本维护设计等内容。

XXX系统的系统设计与实现基于XXX系统的需求分析，总体上将结合形式化设计的方法与文字描述，给出半形式化的概要设计与底层设计，与需求分析内容的相对应，以保证系统设计的严谨性与可实现性。在形式化部分，本文档将主要采取UML语言的包图、类图、序列图等进行系统设计。

本文档的适用读者为XXX系统的产品经理、设计人员、开发人员、测试人员以及后续维护人员。

**术语说明**
------------

**CheckList:**

-   **条目是否都与实际项目相关，非项目相关的条目请删除。**

-   **是否对容易混淆的术语进行了说明，对于容易混淆的术语如"多因子认证"等必须进行说明。**

<!-- -->

-   SSOOS：Security Subsystem Of Operating System，操作系统安全子系统

-   SSF：SSOOS Security
    Functions，SSOOS安全功能模块，在一个SSOOS中可能存在多个SSF

-   主体：Subject，主体是一个主动的实体，它包括用户、用户组、进程等。

-   客体：Object，客体是一个被动的实体。在操作系统中，客体可以是按一定格式存储在一定记录介质上的数据信息（通常以文件系统格式存储数据），也可以是操作系统中的进程。

-   访问控制。AC，即Access
    Control，表示主体对客体的访问需要受到系统基于规则的控制

-   访问控制列表。ACL，即Access Control
    List，即列表形式的访问控制规则，每条规则限定了具体的主体对客体的访问。在Linux下，ACL的主体是用户，客体是文件

-   自主访问控制。DAC，即Discretionary Access
    Control，即客体的属主(owner)对客体设置的，基于属主、属组、其他用户的可读、可写、可执行的访问控制规则

-   强制访问控制。MAC，即Mandatory Access
    Control，即管理员对客体设置的，基于主体安全属性与客体安全属性的访问控制规则。在这里，主体安全属性与客体安全属性可以变化多样，不同的强制访问控制系统会有不同的属性定义

-   LSM，即Linux Security
    Module。在Linux内核中，LSM提供了一个可扩展的强制访问控制机制，各强制访问控制模块可以通过此机制实现自己的策略，对内核的各个操作进行限定，从而可以为系统提供不同的强制访问控制策略

-   审计。Audit，对系统事件进行日志记录，以便事后分析统计的机制

-   Penetration
    Test，渗透测试，即对系统发起的模拟攻击，以发现系统的安全漏洞与安全弱项，并做出报告，提出改进建议与意见

-   PAM：Pluggable Authentication
    Modules，可插拔认证模块，它通过提供动态链接库和一套统一的API，将Linux操作系统中的认证服务和具体的认证实现机制分开，使得管理员可以灵活地根据需要给不同的服务配置不同的认证方式而无需更改服务程序，同时也便于向系统中添加新的认证手段。

-   内核模块：操作系统内核提供的扩展功能，以通过外部模块动态扩展操作系统内核的功能，内核模块的开发一般需要使用对应的内核头文件，以及gcc的C语言编译器。

-   system
    call：系统调用，操作系统给应用程序开发人员提供的开发接口，应用程序开发人员可以调用这些系统调用使用操作系统的功能。

参考资料
--------

**CheckList:参考资料是否都与实际项目相关，非项目相关的条目请删除。**

-   GB/T 20272-2006：《信息安全技术操作系统安全技术要求》
    中华人民共和国标准化委员会 2006年5月

-   GB/T 20271-2006：《信息安全技术信息系统通用安全技术要求》
    中华人民共和国标准化委员会 2006年5月

-   王永吉，吴敬征等 隐蔽信道研究 软件学报 2010年9月

-   沈晴霓，卿斯汉 操作系统安全设计 机械工业出版社 2013年9月

-   李洋 防线:企业Linux安全运维理念和实战 清华大学出版社 2013年8月

-   李志 Linux内核安全模块深入剖析 机械工业出版社 2016年12月

-   软件工程 伊恩·萨默维尔 机械工业出版社 2018年2月

-   [[基于STRIDE进行威胁建模]{.underline}](https://tonydeng.github.io/2022/04/20/threat-modeling-was-conducted-based-on-STRIDE/)

-   [[STRIDE威胁建模漫谈]{.underline}](https://www.secrss.com/articles/3298)

样式说明（正文删除本节）
------------------------

请使用样式和格式中的样式进行文档格式化，不要添加格式中没有的样式。

![](pic/media/image3.png){width="1.18125in"
height="3.277083333333333in"}

1.  样式和格式

正文样式。（样式名为"正文"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，首行缩进2字符，20磅行距，段前0磅，段后0磅"；无边框；无编号。）

命令行（样式名为"命令行"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，无缩进，20磅行距，段前0磅，段后0磅"；无边框，底纹为浅灰色；无编号。）

1.  有序列表样式。（样式名为"有序列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，悬挂缩进0.44厘米，20磅行距，段前0磅，段后0磅"；无边框；编号从1开始，编号后为空格，缩进0.44厘米。）

<!-- -->

1.  有序子列表样式。（样式名为"有序子列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，文本之前0.2厘米，悬挂缩进1.09厘米，20磅行距，段前0磅，段后0磅"；无边框；编号从1开始，编号后无特别标识，对齐位置为0.2厘米,缩进1.29厘米。）

2.  有序子列表样式。

    2.  有序列表样式。

-   无序列表样式。（样式名为"无序列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，悬挂缩进0.63厘米，20磅行距，段前0磅，段后0磅"；无边框；编号使用项目符号■，编号后为空格，缩进0.63厘米。）

<!-- -->

-   无序子列表样式。（样式名为"无序子列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，文本之前0.63厘米，悬挂缩进0.63厘米，20磅行距，段前0磅，段后0磅"；无边框；编号使用项目符号◆，编号后为空格，对齐位置为0.63厘米,缩进1.26厘米。）

-   无序子列表样式。

<!-- -->

-   无序列表样式。

![](pic/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：对正文的补充说明，适用于只有一条注意事项的情况。可以是"注意："、"说明："、"窍门："，不同的场景选择使用不同的词汇。（样式名为"注意/说明/窍门（只有一条）"；字体样式为"CESI宋体-GB18030，倾斜，五号，100%黑色"；段落样式为"两端对齐，正文文本，悬挂缩进1.48厘米，20磅行距，段前0磅，段后0磅"；无边框；无编号；左边的图标中，"注意："/"说明："/"窍门："分别使用![](pic/media/image5.png){width="0.20833333333333334in"
height="0.20416666666666666in"}、![](pic/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}、![](pic/media/image6.png){width="0.20833333333333334in"
height="0.2548611111111111in"}图标，文本对齐方式为居中对齐）。

![](pic/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：

-   对正文的补充说明，适用于有多条注意事项的情况。可以是"注意："、"说明："、"窍门："，不同的场景选择使用不同的词汇。

-   应用样式后需要将"注意："、"说明："、"窍门："单独起一行、应用样式"注意/说明/窍门（只有一条）"；左边的图标中，"注意："/"说明："/"窍门："分别使用![](pic/media/image5.png){width="0.20833333333333334in"
    height="0.20416666666666666in"}、![](pic/media/image4.png){width="0.20833333333333334in"
    height="0.20833333333333334in"}、![](pic/media/image6.png){width="0.20833333333333334in"
    height="0.2548611111111111in"}图标，文本对齐方式为居中对齐。

-   样式名为"注意/说明/窍门（有多条）"；字体样式为"Noto Sans CJK SC
    Regular，倾斜，小五，100%黑色"；段落样式为"两端对齐，正文文本，文本之前1.45厘米，悬挂缩进0.46厘米，20磅行距，段前0磅，段后0磅"；无边框；编号使用项目符号■，左对齐，对齐位置为1.45厘米，编号后为空格，缩进1.91厘米。

    1.  表格样式

  ---------- ---------- ----------
  加粗标题   加粗标题   加粗标题
  项目一     内容       内容
  项目二     内容       内容
  项目三     内容       内容
  
  ---------- ---------- ----------

![](pic/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：

-   "表1.1
    XXX"：使用样式"表描述"；位于表格上方。字体样式为"CESI宋体-GB18030，常规，五号，100%黑色"；段落样式为"居中对齐，正文文本，悬挂缩进1.25厘米，*20磅*行距，段前0磅，段后0磅"，段中不分页，与下段同页；无边框；编号从"表+章节序号+'.'+1"开始，编号后为空格，缩进1.25厘米。

-   标题行：可以将某一行或列作为标题行，使用样式"表标题行"（颜色是白色的，所以在"表描述"附近看到的白色样式即是"表标题行"）。字体样式为"CESI宋体-GB18030，加粗，五号，100%白色"；段落样式为"居中对齐，正文文本，无缩进，*20磅*行距，段前0磅，段后0磅"；无边框；无编号。

-   单元格：可直接使用其他样式，使用后需要将"文本之前"的缩进改成"0"。同一列的对齐方式要统一（内容少时，居中对齐；内容多时，左对齐）。

-   表格：样式需要手动设置。指定宽度为"14.7厘米"，左缩进"0.19厘米"；单元格左右边距为0.19厘米；边框使用实线，100%黑色，0.5磅；标题行使用底纹"0,50,150"。行宽和列宽按需调整。

-   引用表格时请使用域的形式。

![麒麟官网结构图-ps](pic/media/image7.png){width="2.9923611111111112in"
height="5.929861111111111in"}

1.  图样式

![](pic/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：

-   "图1.1
    XXX"：使用样式"图描述"；位于图形下方。字体样式为"CESI宋体-GB18030，常规，五号，100%黑色"；段落样式为"居中对齐，正文文本，悬挂缩进1.25厘米，*20磅*行距，段前0磅，段后0磅"；无边框；编号从"图+章节序号+"."+1"开始，编号后为空格，缩进1.25厘米。（当同一章中同时存在表格和图片，且"表描述"在"图描述"的前面出现，此时第一个"图描述"的编号不正常，需要将其设置为"重新开始编号"。）

-   图形：样式需要手动设置。无缩进，居中对齐，设置与下段同页（如果下段的内容是"图1.1
    XXX"时设置，否则，不设置），如果为操作界面截图且边缘为白色需设置边框（100%黑色、实线、0.5磅），图形尽可能清新但是字号看起来不能大于正文。行距需手动设置为"单倍行距"。

引用图形时请使用域的形式。**推荐使用PlantUML绘制一般的UML图形。使用draw.io绘制其他需要的图形。**

代码段应放在表格中，使用code样式如下：

+--------------------------------------------------------+
| \[Service\]                                            |
|                                                        |
| Type=simple                                            |
|                                                        |
| ExecStart=/usr/lib/deepin-daemon/deepin-example-daemon |
|                                                        |
| ProtectHome=yes                                        |
|                                                        |
| ProtectSystem=strict                                   |
|                                                        |
| \# 按需添加，如果服务不存在写入文件，不要添加多余配置  |
|                                                        |
| RuntimeDirectory=deepin-example-daemon                 |
|                                                        |
| StateDirectory=deepin-example-daemon                   |
|                                                        |
| CacheDirectory=deepin-example-daemon                   |
|                                                        |
| LogsDirectory=deepin-example-daemon                    |
|                                                        |
| ConfigurationDirectory=deepin-example-daemon           |
+--------------------------------------------------------+

以上规则均已经在样式列表中实现，请勿随意添加其他样式。

系统设计
========

设计原则
--------

**CheckList:是否包括对使用的技术栈、框架、依赖版本、约束条件的说明,例如：**

-   **使用的golang、Qt版本：必须满足V20、V23、V25仓库要求。**

-   **框架优先使用Dtk，如有使用非预装库，需要架构部、系统部评审。**

-   **约束条件主要包括支持的架构，如果有不支持架构，需要产品部评审。**

在本小节应阐述本系统在设计时主要考虑到的问题。例如文件搜索主要考虑的问题是搜索速度、资源占用、架构兼容等，窗口管理器主要考虑的问题是freedesktop的协议遵循性、已知的主要违反协议软件的绕过、渲染的性能等。

还可以在这里阐述在设计时主要考虑了哪些问题，例如为什么要使用某种开源协议、为什么要使用Qt而不是gtk，为什么要使用dtk，为什么要使用kprobes而不是ftrace，为什么要使用QtWidget而不是QML，为什么要使用QCef而不是QtWebengine或者QtWebkit等。

需求分析
--------

**CheckList:**

-   **是否覆盖了关键需求，并描述了应达成的技术目标。**

-   **是否分析了关键需求的使用场景或要解决的问题。**

在本小节应阐述本系统对需求的分析，包括使用场景、用户问题等，可结合用例视图、逻辑视图、表格等进行描述。同时应说明实现需求的技术方案概述，以及应达成的技术目标等。

主要模块设计
------------

### 结构设计

**CheckList:**

-   **是否对模块之间的通信方式进行了明确描述，例如DBus、本地Socket、网络端口等。**

-   **是否符合DBus接口设计与安全规范，若使用了DBus,则需要遵循DBus接口设计规范和安全规范。**

在这里需要给出一个大图，或者文字说明本系统中所包含的主要子系统或者主要模块，以及本系统与哪些外部系统需要进行交互。这里的图需要表现的是静态结构，它们可以是：

UML的包图，如图2.1所示

![ie-plus](pic/media/image8.png){width="4.7243055555555555in"
height="2.2020833333333334in"}

2.  UML包图

整体系统结构（例如牵涉到多台机器时，如云打印或者商店或者云音乐等），如图2.2与图2.3所示。

分层图，也就是类似多层架构设计的图，绘制时应遵循上层依赖下层的原则，每层的颜色则应遵循下深上浅的原则。如图2.4所示。

但是不管是哪种图，最终都一定要包含软件模块，而且除了图以外，需要配上文字说明图中每个模块的作用，以及模块之间主要的关系，例如软件模块之间的依赖、继承、组合，或者节点之间的请求、响应、命令控制、数据传输等，模块之间的接口设计需要写清楚，不能太简略。

![inter\_node\_system\_arch](pic/media/image9.png){width="5.75625in"
height="3.1194444444444445in"}

3.  整体系统结构（没有软件模块）

![inner\_node\_system\_arch](pic/media/image10.png){width="4.7243055555555555in"
height="3.629861111111111in"}

4.  整体系统结构（有软件模块）

![layed\_arch](pic/media/image11.png){width="5.759027777777778in"
height="4.019444444444445in"}

5.  多层结构

### 模块A设计

*这里写每个主要模块（不需要不重要模块）的设计，包括模块内部的子模块结构、功能、子模块直接的接口，以及具体由哪个子模块实现父模块与外部模块之间的接口。*

### 模块B设计

### 模块C设计

关键流程设计
------------

**CheckList:**

-   **是否对流程图中的逻辑实体进行了说明，如果流程图存在逻辑实体，必须在文字中说明其对应的物理实体，避免产生理解歧义。比如Greeter-\>
    /usr/bin/lightdm-deepin-greeter。**

-   **是否在功能实现上使用了postinst/postrm/prerm/preinst等脚本，如果使用了，则必须保障对系统升级不产生影响(比如非核心组件只允许返回0退出脚本)，并提供系统部门评审记录。**

关键流程指的是本系统中最关键的功能，例如对于文件搜索来说包括建立索引与文件搜索，对于窗口管理器来说是窗口的焦点、大小、位置与边框的管理。

在这里可以结合上述的静态模块结构设计与接口给出流程设计，例如模块A依赖于模块B，而且模块B提供了接口b1，则在某个关键流程里应该就可以有A调用B的b1方法，传入某某参数，得到某某返回值的连线。建议使用UML的序列图（如图2.5）、协作图（如图2.6）、活动图（如图2.7）、状态图（如图2.8）等来绘制，推荐使用序列图绘制，状态图主要针对一个模块或者子模块内部的流程或者逻辑设计，其它的是多个模块之间的配合以完成功能的流程设计。

除了图以外，要在每个图下面说明。

![用户登录](pic/media/image12.png){width="4.7243055555555555in"
height="3.972916666666667in"}

6.  序列图（又称时序图）

![âuml collaboration
diagramâçå¾çæç´¢ç»æ](pic/media/image13.png){width="5.636805555555555in"
height="2.1958333333333333in"}

7.  协作图（UML Communication diagram）

![](pic/media/image14.png){width="5.754166666666666in"
height="1.229861111111111in"}

8.  活动图

![uc-ug-3](pic/media/image15.png){width="4.7243055555555555in"
height="4.2in"}

9.  状态图

关键接口设计
------------

**CheckList:是否提供了任何形式的对外接口（特别是DBus），如需提供对外接口，则需要业务部门评审，提供必要性分析后，由安全技术部、架构部审核。**

包括对外和对内提供的接口的声明，以及输入、输出参数的描述。对于非对外接口应添加Internal标识。

关键数据结构设计
----------------

包括应用软件外部存储的主要数据结构（例如文件搜索的索引文件内容），应用程序内部主要的数据结构、使用到的数据库的主要库表设计、关键的配置数据等。最好给出哪些数据结构被哪些模块使用到了。

数据库设计
----------

对于使用到数据库的项目，需要有该章节，否则可以进行裁剪，需符合数据库设计规范的要求。

### 数据库设计概述

在此处描述数据库并发访问量、数据传输流量、数据增长幅度等相关信息。通过分析项目的一些特性，是否需要进行拆库拆表设计。数据中存储了一些有过期属性的数据时，这些数据的处理方案（随着系统运行，该类型数据有可能会大量增长，影响系统的性能）。

### 数据库信息

2.  数据库信息

+------------------------------+---------------------------+
| 数据库相关属性               | 各属性相关参数信息        |
+------------------------------+---------------------------+
| 数据库类型                   | Mysql                     |
+------------------------------+---------------------------+
| 数据库版本                   | 8.0                       |
+------------------------------+---------------------------+
| 数据库部署环境               | 测试环境：公司内部服务器  |
|                              |                           |
|                              | 生产环境：阿里云RDS服务器 |
+------------------------------+---------------------------+
| 数据库实例名称               | unionid                   |
+------------------------------+---------------------------+
| 数据库字符集编码             | utf8mb4                   |
+------------------------------+---------------------------+
| 数据库默认排序规则           | utf8mb4\_bin              |
+------------------------------+---------------------------+
| 使用数据库的一些特性\...\... |                           |
+------------------------------+---------------------------+

### 数据库ER图设计

在此处提供数据库的ER图。

![er](pic/media/image16.png){width="4.7243055555555555in"
height="3.2743055555555554in"}

10. 数据库E-R图

### 数据库表结构

本节详细的定义数据库中相关的表结构，表结构中的数据类型定义以满足当前项目数据需要为主，根据项目的实际情况，有可能有部分数据的特性需要一定的拓展性，可以适当的调整数据类型的精度或长度。例如：使用uuid做主键id时，此时的数据类型需要定义为char(32),存储时间时，如果是日期精度，使用date类型，如果有时间信息，使用timestamp类型。在进行数据类型定义（字符串类型）时，需要注意字符编码导致的长度问题。（需要注意的是，存储在数据库中的一些关键性数据不要存储一些非必要的数据信息，例如uuid可以去除-信息）。

3.  数据库表集合

---------- ------------
  表名       功能
  user       用户表
  userinfo   用户拓展表
---------- ------------

#### user表

表功能描述：用于存储用户相关信息。

4.  user表

---------- ---------- ------------------ --------------
  列名       类型       说明               描述
  Id         Int        主键               用户id
  OpenID     Char(32)   Unique，not null   用户的开放id
  UnionID    Char(32)                      用户的联合id
  Phone      Char(11)                      用户手机号
  Sex        Byte       男，女             用户性别
  \...\...   \...\...                      \...\...
---------- ---------- ------------------ --------------

数据表创建sql:

+------------------------------+
| CREATE TABLE \`user\` (      |
|                              |
| \`ID\` int PRIMARY KEY,      |
|                              |
| \`OpenID\` char(32) UNIQUE,  |
|                              |
| \`UnionID\` char(32) UNIQUE, |
|                              |
| \`Phone\` char(11),          |
|                              |
| \`Sex\` int8                 |
|                              |
| )                            |
+------------------------------+

#### **userinfo表**

表功能描述：用于存储用户相关拓展信息。

5.  user表

---------- -------------- ---------- ----------
  列名       类型           说明       描述
  Id         Int            主键       用户id
  Company    Varchar(100)              公司名称
  \...\...   \...\...       \...\...   \...\...
---------- -------------- ---------- ----------

数据表创建sql:

+----------------------------+
| CREATE TABLE \`userinfo\`( |
|                            |
| \`ID\` int PRIMARY KEY,    |
|                            |
| \`Company\` VARCHAR(100)   |
|                            |
| )                          |
+----------------------------+

### 表结构约束

在此处定义数据库中各表的相关约束和索引的定义(在可行的情况下，可以将部分约束的定义转移至表结构设计部分)。

#### **user表**

+-----------------------------------------------------------------------+
| ALTER TABLE \`user\` ADD CONSTRAINT ck\_user\_sex CHECK(\`sex\`       |
| BETWEEN 0 AND 1) ;                                                    |
|                                                                       |
| ALTER TABLE \`user\` ADD INDEX idx\_user\_openid(\`OpenID\`)          |
+-----------------------------------------------------------------------+

#### **userinfo表**

---------------------------------------------------------------------------------------------------------------------
  ALTER TABLE \`userinfo\` ADD CONSTRAINT fk\_userinfo\_id\_user\_id FOREIGN KEY(\`ID\`) REFERENCES \`user\`(\`ID\`);
  ---------------------------------------------------------------------------------------------------------------------

### 数据库视图

在此处定义数据库视图的相关信息。

6.  数据库视图集合

------------ --------------
  视图名称     视图作用
  userdetail   用户详细信息
  \...\...     \...\...
------------ --------------

#### **view\_userdetail**

在此处描述创建该视图的原因、使用场景等。

7.  view\_userdetail表

---------- ----------
  列名       描述
  ID         
  Phone      手机号
  Company    公司
  \...\...   \...\...
---------- ----------

视图定义sql：

+-----------------------------------------------------------------------+
| CREATE VIEW \`userdetail\` AS                                         |
|                                                                       |
| SELECT \`user\`.\`ID\`,\`user\`.\`Phone\`,\`userinfo\`.\`Company\`    |
| FROM \`user\` JOIN \`userinfo\` ON \`user\`.ID=\`userinfo\`.\`ID\`    |
+-----------------------------------------------------------------------+

### 存储过程

如果在项目中使用了存储过程，在此处进行定义。

### 触发器

如果在项目中使用了触发器，在此处进行定义。

### 函数

如果在项目中使用了自定义函数，在此处进行定义。

### 数据安全

数据安全核心是将数据中的机密信息进行脱敏处理，脱敏方式主要包括两类：1.可逆性数据加密
2.不可逆的数据hash摘要。需要根据实际情况，选择对应的方式。此处详细的定义涉及到数据安全的相关数据表设计。

8.  数据脱敏方式表

------ ---------- ---------- -------------
  表名   列名       脱敏方式   脱敏算法
  user   Phone      数据加密   aes加密
  user   Password   Hash摘要   slat+sha256
------ ---------- ---------- -------------

主要人机交互设计
----------------

对于有图形界面的软件，应给出关键的人机交互设计，包括主要的界面线框图设计，以及各个界面之间的流转等。最好给出主要的图形界面与模块的对应关系。

该部分需要给出实际的界面设计原型图，或则使用UML工具绘制线框图。

![slat](pic/media/image17.png){width="3.9368055555555554in"
height="3.301388888888889in"}

11. 界面线框图

非功能性设计
============

**CheckList:是否明确了计划达成的指标和达成指标的方案。**

下面几项可以不用都写，因为不是每个软件都需要考虑到所有点。

安全性
------

例如：

-   输入密码等认证信息是否使用了加密手段进行输入保护和传输保护

-   加密强度是否高，是否采用了框架式的实现方式，加密算法是否可替换

-   图形界面程序是否使用了root权限运行（含capabilities）运行

-   图形界面程序进行高权限操作是否配置了polkit

-   用户数据（如密码与隐私数据）在传输、存储时有没有加密保护

-   用户敏感数据是否配置了合适的访问控制策略

-   是否有不经用户允许保存或者传输用户数据

-   系统服务是否通过systemd service限制了权限，是否满足最小化权限的要求

-   系统服务的关键操作是否进行了审计，优先使用audit进行记录

-   系统接口是否对调用者进行了身份验证，是否检查了调用者对客体的权限

-   系统接口是否对传入参数进行了参数类型、值范围和完整性的检查

-   系统接口是否使用了文件路径作为了参数

-   系统接口是否使用了命令作为了参数

-   系统接口是否进行了威胁分析

可以结合前述的具体模块与流程来体现如何在模块设计时或者整体系统设计时考虑了安全问题。

性能
----

例如：

-   启动时间设计优化

-   资源（处理器、内存、硬盘、网络）占用设计优化

-   减少对系统或者其他软件运行的性能影响设计考量

-   数据吞吐量或者用户响应延迟设计优化

-   具体例如：

-   使用了什么算法或者数据结构

-   使用了什么高效的库

-   使用了无锁设计或者高性能并发程序设计

-   使用缓存

-   使用了异步IO，等等。

可以结合前述的具体模块与流程来体现如何在模块设计时或者整体系统设计时考虑了性能问题。

可靠性
------

例如：

-   在设计上如何避免程序的异常退出（包括指针错误、内存溢出、异常处理、错误处理、异常断电等）与僵死（例如是否进行了异步设计，在可能长时间操作时是否使用多线程等）

-   如何保证在多种运行环境下程序占用的资源基本不变（例如用户数据太大时进行分段处理，而不是一次性读入，以及设计了广泛的单元测试，在各种边界数据下都会保证程序的正常运行等等）

可以结合前述的具体模块与流程来体现如何在模块设计时或者整体系统设计时考虑了可靠性问题。

易用性
------

例如：

-   色彩、布局或者操作等搭配是否合理或一致

-   如何设计使得新手能在短时间之内快速熟练使用主要功能

-   是否支持Tab健与常用快捷键

-   在耗时操作与可能造成数据损失的操作前有没有明确提示

-   是否提供了应有的系统状态显示（如耗时操作没有进度与取消功能）

-   是否支持撤销与重做

-   是否提供了帮助

-   是否支持国际化（至少应缺省提供中文简体与英文两种语言的支持）

-   是否支持主题等

-   是否支持触摸屏

可以结合前述的具体模块、流程与人机交互流程来体现如何在模块设计时或者整体系统设计时考虑了易用性问题。

可用性
------

主要对于服务器程序与守护程序等需要长期稳定运行的程序的设计考虑，即如何保证系统能长时间稳定运行，以及一旦崩溃是否有机制自动检测到，并重启软件，或者友好地提示用户进行手工重启等。可以结合前述的具体模块与流程来体现如何在模块设计时或者整体系统设计时考虑了可用性问题。

兼容性
------

**CheckList：是否说明了对外提供的API的变更情况，并包含评审通过的记录。**

多硬件平台的支持，多种软件的支持，多种库的支持，以及系统自身的跨版本兼容性设计等。可以结合前述的具体模块与流程来体现如何在模块设计时或者整体系统设计时考虑了兼容性问题。

韧性
----

**CheckList:关键组件是否提供重试与恢复机制，以保障在极端情况下的功能正常。特别是桌面环境、任务栏、桌面。例如低内存时应优先释放应用资源，保障桌面可操作。**

韧性是《软件工程（第十版）》，2017年提出的概念。目前（2021）还没有对韧性形成一个共识，但是可以认为韧性是可靠性的一个概念，对其定义如下：

系统的韧性是指系统在出现破坏性事件（例如设备失效和网络攻击）的情况下，能够保持系统关系服务的连续性的程度。

例如：系统设计时，认为用户的输入是可靠的，且用户不会刻意的去触发已知的Bug或则漏洞，但是，当这个系统的使用环境发生变化，比如系统被暴露到公共环境中，任何人都可以接触到系统，那么系统设计的前提不再生效；而一个有韧性的系统，能够应对这种环境并且正常运行。

隐私
----

**CheckList：是否在堆栈信息，收集日志等信息中存在用户名、密码、用户文件路径等敏感信息。例如收集了用户打开的文件清单。**

隐私设计包括数据保护、隐私保护等方面。其具体内容需要包括在隐私保护方面做出了具体的设计与功能，包括：

-   传输时对邮箱/手机号进行匿名化处理

-   界面显示时，关键信息需要验证后才能显示

-   符合各国隐私相关法规，包括欧盟的《GDPR》，中国的《网络安全法》、《个人信息安全规范》

-   对日志做匿名化处理

可维护性
--------

**CheckList：**

-   **是否写清项目的日志收集方式与手段，全部的调试开关开启方式，以加入到测试用例中供测试团队使用。**

-   **自研应用是否只使用了Dtk提供的日志库。非Dtk应用默认使用joural日志。**

可维护性包括编码规范、日志规范、数据采集、模块化、自动化测试、可配置等方面。其具体内容需要包括在编码规范、模块化、自动化、可配置等方面做出了具体的设计与功能，包括：

-   日志按照日志规范进行记录，包含所有的错误和异常，以及对日志级别动态调整的支持

-   数据采集的事件范围，同时要符合上报信息的格式

-   结构设计时，应按照高内聚、低耦合的思想进行模块化设计

-   功能可配置的范围，以及对配置动态调整的支持

-   对单元测试和功能测试自动化率的要求

部署与实施
==========

**CheckList：**

-   **新包创建或依赖变更时是否通过了评审，必须提供系统部评审记录。**

-   **自启程序是否都通过了评审，必须提供系统部、架构部的评审记录。**

在系统部署与实施方面的设计，例如整个系统在部署时有哪些组件（包括配置文件、动态库、可执行程序、依赖的其它软件等），推荐使用UML的部署图来绘制，如图4.1或者图4.2、图4.3所示。在这里还可以继续阐述如何进行系统的升级维护，例如通过仓库进行管理，soname的规则等。

![](pic/media/image18.png){width="3.9368055555555554in"
height="4.89375in"}

12. 智能Wifi部署图

![](pic/media/image19.png){width="2.3625in"
height="1.3395833333333333in"}

13. 火狐插件部署图

![](pic/media/image20.png){width="5.759722222222222in"
height="2.84375in"}

14. 主从部署图

专利
====

以列表形式提供计划产生的专利，如：

9.  专利列表

-------- ---------------------- ----------
  专利点   技术关键点和欲保护点   有益效果
  xxx      xxx                    xxx
-------- ---------------------- ----------

附录
====

文档相关的附件，可根据项目情况添加，如数据库设计规范、接口说明列表等。

变更记录
========

描述文档每次变更的详细信息，需归档旧版本。

---------------------------------------------------------------------------------------------------------- --------- -------------- -------------------

  **【模板】概要设计说明书**                                                                                                          
  ![统信软件logo-专色蓝](pic/media/image2.png){width="3.1506944444444445in" height="1.3173611111111112in"}                            
  **版本号**                                                                                                 A01       **文件编号**   UT-3-RD-PR-003-03
  **文档密级**                                                                                               C级商密   **编制部门**   架构部
  **编制人**                                                                                                 闫博文    **日期**       2024年7月18日
  **审核人**                                                                                                 李鹤      **日期**       2024年9月25日
  **批准人**                                                                                                 张磊      **日期**       2024年9月27日
---------------------------------------------------------------------------------------------------------- --------- -------------- -------------------

**模板修订记录**

+---------+---------+---------+---------+---------+---------+---------+
| **序号** | **版本** | **修订内容简 | **修订日期* | **修订人** | **审核人** | **批准人** |
|         |         | 述**    | *       |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 1       | V1.0    | 创建    | 2019-01 | 张磊    | 张磊    | 张磊    |
|         |         |         | -07     |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 2       | V1.1    | 更新样式 | 2021-01 | 李鹤、赵鹏、闫 | 李鹤 | 张磊 |
|         |         |         | -26     | 博文    |         |         |
|         |         |         |         |         |         |         |
|         |         | 添加隐私/韧性 |   |         |         |         |
|         |         | 设计说明 |        |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 使用Plant |       |         |         |         |
|         |         | UML更新图例 |     |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 添加数据库设计 |  |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 添加附录、变更 |  |         |         |         |
|         |         | 记录    |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 3       | V1.2    | 修订LOGO及 | 2021-8- | 赵鹏 | 李鹤    | 崔湛    |
|         |         | 样式    | 7       |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 4       | V1.3    | 更新封面页、页 | 2022-5- | 赵鹏 | 李鹤 | 崔湛   |
|         |         | 眉页脚样式及文 | 18 |       |         |         |
|         |         | 件密级  |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 5       | A01     | 修改样式，添加 | 2024-07 | 闫博文、李鹤 | 李鹤 | 张磊 |
|         |         | checkli | -25     |         |         |         |
|         |         | st；更新发布 |    |         |         |         |
|         |         | 范围：适用产研 |  |         |         |         |
|         |         | 平台。  |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
