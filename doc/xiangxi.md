  ----------------------------------------------------------------------------------------------------------- -- -------------- ----------------
                                                                                                                                
  **XXX项目详细设计说明书**                                                                                                     
  ![统信软件logo-专色蓝](pic1/media/image2.png){width="3.1506944444444445in" height="1.3173611111111112in"}                     
  **配置项编号**                                                                                                 **版本号**     
  **文档密级**                                                                                                   **编制部门**   
  **编制人**                                                                                                     **日期**       XXXX年XX月XX日
  **审核人**                                                                                                     **日期**       XXXX年XX月XX日
  **批准人**                                                                                                     **日期**       XXXX年XX月XX日
  ----------------------------------------------------------------------------------------------------------- -- -------------- ----------------

修订记录

  ---------- ------------ ------------------ -------------- ------------ ------------ ------------
  **序号**   **版本号**   **修订内容描述**   **修订日期**   **修订人**   **审核人**   **批准人**
  1          V1.0         新建                                                        
  ---------- ------------ ------------------ -------------- ------------ ------------ ------------

目录

1 概述 1

[1.1 目的 1](\l)

[1.2 术语说明 1](\l)

[1.3 参考资料 2](\l)

[1.4 样式说明（正文删除本节） 2](\l)

[2 模块设计 7](\l)

[2.1 设计约束 7](\l)

[2.2 系统模块设计 7](\l)

[2.2.2 模块A设计 9](\l)

[2.2.3 模块B设计 10](\l)

[2.2.4 模块C设计 10](\l)

[3 全局数据结构设计 10](\l)

[4 安全风险分析 10](\l)

[5 人机交互设计 10](\l)

[6 部署方案 11](\l)

[7 附录 11](\l)

[8 变更记录 11](\l)

概述
====

目的
----

本文档是针对XXX系统给出的系统详细设计文档，在本文档中，将给出XXX系统的系统设计原则、关键静态结构设计、关键动态流程设计、数据结构设计、人机交互设计、非功能性设计、系统部署与实施设计、版本维护设计等内容。

XXX系统的系统设计与实现基于XXX系统的需求分析，总体上将结合形式化设计的方法与文字描述，给出半形式化的概要设计与底层设计，与需求分析内容的相对应，以保证系统设计的严谨性与可实现性。在形式化部分，本文档将主要采取UML语言的包图、类图、序列图等进行系统设计。

本文档的适用读者为XXX系统的产品经理、设计人员、开发人员、测试人员以及后续维护人员。

术语说明
--------

**CheckList:**

-   **条目是否都与实际项目相关，非项目相关的条目请删除。**

-   **是否对容易混淆的术语进行了说明，对于容易混淆的术语如"多因子认证"等必须进行说明。**

<!-- -->

-   SSOOS：Security Subsystem Of Operating System，操作系统安全子系统。

-   SSF：SSOOS Security
    Functions，SSOOS安全功能模块，在一个SSOOS中可能存在多个SSF。

-   主体：Subject，主体是一个主动的实体，它包括用户、用户组、进程等。

-   客体：Object，客体是一个被动的实体。在操作系统中，客体可以是按一定格式存储在一定记录介质上的数据信息（通常以文件系统格式存储数据），也可以是操作系统中的进程。

-   访问控制。AC，即Access
    Control，表示主体对客体的访问需要受到系统基于规则的控制。

-   访问控制列表。ACL，即Access Control
    List，即列表形式的访问控制规则，每条规则限定了具体的主体对客体的访问。在Linux下，ACL的主体是用户，客体是文件。

-   自主访问控制。DAC，即Discretionary Access
    Control，即客体的属主(owner)对客体设置的，基于属主、属组、其他用户的可读、可写、可执行的访问控制规则。

-   强制访问控制。MAC，即Mandatory Access
    Control，即管理员对客体设置的，基于主体安全属性与客体安全属性的访问控制规则。在这里，主体安全属性与客体安全属性可以变化多样，不同的强制访问控制系统会有不同的属性定义。

-   LSM，即Linux Security
    Module。在Linux内核中，LSM提供了一个可扩展的强制访问控制机制，各强制访问控制模块可以通过此机制实现自己的策略，对内核的各个操作进行限定，从而可以为系统提供不同的强制访问控制策略。

-   审计。Audit，对系统事件进行日志记录，以便事后分析统计的机制。

-   Penetration
    Test，渗透测试，即对系统发起的模拟攻击，以发现系统的安全漏洞与安全弱项，并做出报告，提出改进建议与意见。

-   PAM：Pluggable Authentication
    Modules，可插拔认证模块，它通过提供动态链接库和一套统一的API，将Linux操作系统中的认证服务和具体的认证实现机制分开，使得管理员可以灵活地根据需要给不同的服务配置不同的认证方式而无需更改服务程序，同时也便于向系统中添加新的认证手段。

-   内核模块：操作系统内核提供的扩展功能，以通过外部模块动态扩展操作系统内核的功能，内核模块的开发一般需要使用对应的内核头文件，以及gcc的C语言编译器。

-   system
    call：系统调用，操作系统给应用程序开发人员提供的开发接口，应用程序开发人员可以调用这些系统调用使用操作系统的功能。

参考资料
--------

**CheckList:参考资料是否都与实际项目相关，非项目相关的条目请删除。**

-   GB/T 20272-2006：《信息安全技术操作系统安全技术要求》
    中华人民共和国标准化委员会 2006年5月

-   GB/T 20271-2006：《信息安全技术信息系统通用安全技术要求》
    中华人民共和国标准化委员会 2006年5月

-   王永吉，吴敬征等 隐蔽信道研究 软件学报 2010年9月

-   沈晴霓，卿斯汉 操作系统安全设计 机械工业出版社 2013年9月

-   李洋 防线:企业Linux安全运维理念和实战 清华大学出版社 2013年8月

-   李志 Linux内核安全模块深入剖析 机械工业出版社 2016年12月

-   软件工程 伊恩·萨默维尔 机械工业出版社 2018年2月

样式说明（正文删除本节）
------------------------

请使用**样式和格式**中的样式进行文档格式化，不要添加格式中没有的样式。

![](pic1/media/image3.png){width="1.18125in"
height="3.277083333333333in"}

1.  样式和格式

正文样式。（样式名为"正文"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，首行缩进2字符，20磅行距，段前0磅，段后0磅"；无边框；无编号。）

命令行（样式名为"命令行"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，无缩进，20磅行距，段前0磅，段后0磅"；无边框，底纹为浅灰色；无编号。）

1.  有序列表样式。（样式名为"有序列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，悬挂缩进0.44厘米，20磅行距，段前0磅，段后0磅"；无边框；编号从1开始，编号后为空格，缩进0.44厘米。）

<!-- -->

1.  有序子列表样式。（样式名为"有序子列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，文本之前0.2厘米，悬挂缩进1.09厘米，20磅行距，段前0磅，段后0磅"；无边框；编号从1开始，编号后无特别标识，对齐位置为0.2厘米,缩进1.29厘米。）

2.  有序子列表样式。

    2.  有序列表样式。

-   无序列表样式。（样式名为"无序列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，悬挂缩进0.63厘米，20磅行距，段前0磅，段后0磅"；无边框；编号使用项目符号■，编号后为空格，缩进0.63厘米。）

<!-- -->

-   无序子列表样式。（样式名为"无序子列表"；字体样式为"CESI宋体-GB18030，常规，小四，100%黑色"；段落样式为"两端对齐，正文文本，文本之前0.63厘米，悬挂缩进0.63厘米，20磅行距，段前0磅，段后0磅"；无边框；编号使用项目符号◆，编号后为空格，对齐位置为0.63厘米,缩进1.26厘米。）

-   无序子列表样式。

<!-- -->

-   无序列表样式。

![](pic1/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：对正文的补充说明，适用于只有一条注意事项的情况。可以是"注意："、"说明："、"窍门："，不同的场景选择使用不同的词汇。（样式名为"注意/说明/窍门（只有一条）"；字体样式为"Noto
Sans CJK SC
Regular，倾斜，小五，100%黑色"；段落样式为"两端对齐，正文文本，悬挂缩进1.48厘米，20磅行距，段前0磅，段后0磅"；无边框；无编号；左边的图标中，"注意："/"说明："/"窍门："分别使用![](pic1/media/image5.png){width="0.20833333333333334in"
height="0.20416666666666666in"}、![](pic1/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}、![](pic1/media/image6.png){width="0.20833333333333334in"
height="0.2548611111111111in"}图标，文本对齐方式为居中对齐）。

![](pic1/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：

-   对正文的补充说明，适用于有多条注意事项的情况。可以是"注意："、"说明："、"窍门："，不同的场景选择使用不同的词汇。

-   应用样式后需要将"注意："、"说明："、"窍门："单独起一行、应用样式"注意/说明/窍门（只有一条）"；左边的图标中，"注意："/"说明："/"窍门："分别使用![](pic1/media/image5.png){width="0.20833333333333334in"
    height="0.20416666666666666in"}、![](pic1/media/image4.png){width="0.20833333333333334in"
    height="0.20833333333333334in"}、![](pic1/media/image6.png){width="0.20833333333333334in"
    height="0.2548611111111111in"}图标，文本对齐方式为居中对齐。

-   样式名为"注意/说明/窍门（有多条）"；字体样式为"CESI宋体-GB18030，倾斜，五号，100%黑色"；段落样式为"两端对齐，正文文本，文本之前1.45厘米，悬挂缩进0.46厘米，20磅行距，段前0磅，段后0磅"；无边框；编号使用项目符号■，左对齐，对齐位置为1.45厘米，编号后为空格，缩进1.91厘米。

    1.  表格样式

  ---------- ---------- ----------
  加粗标题   加粗标题   加粗标题
  项目一     内容       内容
  项目二     内容       内容
  项目三     内容       内容
  ---------- ---------- ----------

![](pic1/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：

-   "表1.1
    XXX"：使用样式"表描述"；位于表格上方。字体样式为"CESI宋体-GB18030，常规，五号，100%黑色"；段落样式为"居中对齐，正文文本，悬挂缩进1.25厘米，*20磅*行距，段前0磅，段后0磅"，段中不分页，与下段同页；无边框；编号从"表+章节序号+'.'+1"开始，编号后为空格，缩进1.25厘米。

-   标题行：可以将某一行或列作为标题行，使用样式"表标题行"（颜色是白色的，所以在"表描述"附近看到的白色样式即是"表标题行"）。字体样式为"CESI宋体-GB18030，加粗，五号，100%白色"；段落样式为"居中对齐，正文文本，无缩进，*20磅*行距，段前0磅，段后0磅"；无边框；无编号。

-   单元格：可直接使用其他样式，使用后需要将"文本之前"的缩进改成"0"。同一列的对齐方式要统一（内容少时，居中对齐；内容多时，左对齐）。

-   表格：样式需要手动设置。指定宽度为"14.7厘米"，左缩进"0.19厘米"；单元格左右边距为0.19厘米；边框使用实线，100%黑色，0.5磅；标题行使用底纹"0,50,150"。行宽和列宽按需调整。

-   引用表格时请使用域的形式。

![麒麟官网结构图-ps](pic1/media/image7.png){width="2.9923611111111112in"
height="5.929861111111111in"}

1.  图样式

![](pic1/media/image4.png){width="0.20833333333333334in"
height="0.20833333333333334in"}说明：

-   "图1.1
    XXX"：使用样式"图描述"；位于图形下方。字体样式为"NCESI宋体-GB18030，常规，五号，100%黑色"；段落样式为"居中对齐，正文文本，悬挂缩进1.25厘米，*20磅*行距，段前0磅，段后0磅"；无边框；编号从"图+章节序号+"."+1"开始，编号后为空格，缩进1.25厘米。（当同一章中同时存在表格和图片，且"表描述"在"图描述"的前面出现，此时第一个"图描述"的编号不正常，需要将其设置为"重新开始编号"。）

-   图形：样式需要手动设置。无缩进，居中对齐，设置与下段同页（如果下段的内容是"图1.1
    XXX"时设置，否则，不设置），如果为操作界面截图且边缘为白色需设置边框（100%黑色、实线、0.5磅），图形尽可能清新但是字号看起来不能大于正文。行距需手动设置为"单倍行距"。

引用图形时请使用域的形式。**推荐使用PlantUML绘制一般的UML图形。使用draw.io绘制其他需要的图形。**

代码段应放在表格中，如下：

+--------------------------------------------------------+
| \[Service\]                                            |
|                                                        |
| Type=simple                                            |
|                                                        |
| ExecStart=/usr/lib/deepin-daemon/deepin-example-daemon |
|                                                        |
| ProtectHome=yes                                        |
|                                                        |
| ProtectSystem=strict                                   |
|                                                        |
| \# 按需添加，如果服务不存在写入文件，不要添加多余配置  |
|                                                        |
| RuntimeDirectory=deepin-example-daemon                 |
|                                                        |
| StateDirectory=deepin-example-daemon                   |
|                                                        |
| CacheDirectory=deepin-example-daemon                   |
|                                                        |
| LogsDirectory=deepin-example-daemon                    |
|                                                        |
| ConfigurationDirectory=deepin-example-daemon           |
+--------------------------------------------------------+

以上规则均已经在样式列表中实现，请勿随意添加其他样式。

 模块设计
=========

设计约束
--------

**CheckList:是否包括对目录结构、版权申明、构建工具等的说明，如：**

-   **使用的golang、Qt版本：必须满足V20、V23、V25仓库要求。**

-   **框架优先使用Dtk，如有使用非预装库，需要架构部、系统部评审。**

-   **构建工具优先使用CMake、gcc，如需使用其他构建工具，需要架构部、系统部评审。**

-   **源码目录结构是否符合编码规范要求。**

例如应该遵循什么实现的原则，比如源码目录结构、简单的编码规则，每个源码文件应该包含什么版权申明，是否要做单元测试，是否采用CMake或者Makefile或者gcc/clang等构建工具等。

系统模块设计
------------

**CheckList:**

-   **是否对模块之间的通信方式进行了明确描述，例如DBus、本地Socket、网络端口。**

-   **是否符合DBus接口设计与安全规范，若使用了DBus,则需要遵循DBus接口设计规范和安全规范。**

在这里需要给出一个大图，或者文字说明本系统中所包含的**所有**子系统或者模块，以及本系统与哪些外部系统需要进行交互（编译和运行时都依赖于哪些软硬件，包括具体的版本）。这里的图需要表现的是静态结构，它们可以是：

**特别注意，在详细设计中，要给出所有的模块的图，而不是只有重要模块。**

UML的包图，如图2.1所示：

![ie-plus](pic1/media/image8.png){width="4.7243055555555555in"
height="2.2020833333333334in"}

2.  UML包图

*整体系统结构（例如牵涉到多台机器时，如云打印或者商店或者云音乐等），如图2.2与图2.3所示。*

*分层图，也就是类似多层架构设计的图，绘制时应遵循上层依赖下层的原则，每层的颜色则应遵循下深上浅的原则。如图2.4所示。*

*但是不管是哪种图，最终都一定要包含软件模块，而且除了图以外，需要配上文字说明图中每个模块的作用，以及模块之间主要的关系，例如软件模块之间的依赖、继承、组合，或者节点之间的请求、响应、命令控制、数据传输等，模块之间的接口设计需要写清楚，不能太简略。*

![inter\_node\_system\_arch](pic1/media/image9.png){width="5.75625in"
height="3.1194444444444445in"}

3.  整体系统结构（没有软件模块）

![inner\_node\_system\_arch](pic1/media/image10.png){width="4.7243055555555555in"
height="3.629861111111111in"}

4.  整体系统结构（有软件模块）

![layed\_arch](pic1/media/image11.png){width="5.759027777777778in"
height="4.019444444444445in"}

5.  多层结构

### 模块A设计

*下面是每个模块的设计，包括模块内部的子模块结构、功能、子模块之间的接口，以及具体由哪个子模块实现父模块与外部模块之间的接口。如果本模块下面有子模块，则应按照此结构递归撰写每个子模块的详细设计。*

#### 模块功能

*对于C++等面向对象的语言而言，这里的模块应该是类。对于C等面向过程的语言而言，这里的模块应该是.h文件与.c文件合成的逻辑模块。*

#### 主要接口

**CheckList:是否提供了任何形式的对外接口（特别是DBus），如需提供对外接口，则需要业务部门评审，提供必要性分析后，由安全技术部、架构部审核。**

*若是C++等面向对象的语言，在这里应给出类的每个公共方法（public
method）与保护方法（protected
method）的主要功能，以及每个方法的参数说明与返回值。对于C等面向过程的语言，在这里应该出头文件里导出的函数的主要功能，以及每个函数的参数说明与返回值。*

#### 逻辑流程

**CheckList:**

-   **是否对流程图中的逻辑实体进行了说明，如果流程图存在逻辑实体，必须在文字中说明其对应的物理实体，避免产生理解歧义。比如Greeter-\>
    /usr/bin/lightdm-deepin-greeter。**

-   **是否在功能实现上使用了postinst/postrm/prerm/preinst等脚本，如果使用了，则必须保障对系统升级不产生影响(比如非核心组件只允许返回0退出脚本)，并提供系统部门评审记录。**

*若是C++等面向对象的语言，在这里应给出类的每个公共方法（public
method）与保护方法（protected
method）的主要流程，可以通过UML的序列图（若有子模块或者与其它的模块交互较多）或状态图给出。对于C等面向过程的语言，在这里应该出头文件里导出的函数的主要流程，可以通过UML的序列图（若有子模块或者与其它的模块交互较多）或状态图给出。*

#### 错误处理

*若是C++等面向对象的语言，在这里应给出类的每个公共方法（public
method）与保护方法（protected
method）的错误处理，例如在什么情况下返回什么错误码，是否会记录日志或者产生异常等。对于C等面向过程的语言，在这里应该出头文件里导出的函数的错误处理，例如在什么情况下返回什么错误码，是否会记录日志等模块B设计*

### 模块B设计

### 模块C设计

全局数据结构设计
================

*包括应用软件外部存储的主要数据结构（例如文件搜索的索引文件内容），应用程序内部主要的数据结构、使用到的数据库的主要库表设计、关键的配置数据等。最好给出哪些数据结构被哪些模块使用到了。*

安全风险分析
============

**CheckList:是否与安全部一同完成了安全风险分析，必须提供安全部的评审记录。**

*需要对项目进行安全风险分析，进行威胁建模，可联系安全部的同事一同完成。*

人机交互设计
============

*对于有图形界面的软件，应给出关键的人机交互设计，包括主要的界面线框图设计，以及各个界面之间的流转等。最好给出主要的图形界面与模块的对应关系。*

*该部分需要给出实际的界面设计原型图，或则使用UML工具绘制线框图。*

![slat](pic1/media/image12.png){width="3.9368055555555554in"
height="3.301388888888889in"}

6.  界面线框图

部署方案
========

本段根据具体的项目／产品需求，给出详细的、可指导实施的部署方案。包括部署流程图、物理视图。

附录
====

*文档相关的附件，可根据项目情况添加，如接口说明文件等。Web
项目的接口可提供 Swagger 文件进行描述。*

变更记录
========

*描述文档每次变更的详细信息，需归档旧版本。*

  ----------------------------------------------------------------------------------------------------------- --------- -------------- -------------------
                                                                                                                                       
  **【模板】详细设计说明书**                                                                                                           
  ![统信软件logo-专色蓝](pic1/media/image2.png){width="3.1506944444444445in" height="1.3173611111111112in"}                            
  **版本号**                                                                                                  A01       **文件编号**   UT-3-RD-PR-003-04
  **文档密级**                                                                                                C级商密   **编制部门**   架构部
  **编制人**                                                                                                  闫博文    **日期**       2024年07月24日
  **审核人**                                                                                                  李鹤      **日期**       2024年9月25日
  **批准人**                                                                                                  张磊      **日期**       2024年9月27日
  ----------------------------------------------------------------------------------------------------------- --------- -------------- -------------------

**模板修订记录**

+---------+---------+---------+---------+---------+---------+---------+
| **序号** | **版本** | **修订内容简 | **修订日期* | **修订人** | **审核人** | **批准人** |
|         |         | 述**    | *       |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 1       | V1.0    | 新建    | 2019-04 | 赵鹏    | 李鹤    | 张磊    |
|         |         |         | -26     |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 2       | V1.1    | 更新样式 | 2021-01 | 李鹤、闫博文 | 李鹤 | 崔湛 |
|         |         |         | -27     |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 添加隐私/韧性 |   |         |         |         |
|         |         | 设计说明 |        |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 使用Plant |       |         |         |         |
|         |         | UML更新图例 |     |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 添加部署说明 |    |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         | 添加附录、变更 |  |         |         |         |
|         |         | 记录    |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 3       | V1.2    | 修订LOGO及 | 2021-08 | 赵鹏 | 李鹤    | 崔湛    |
|         |         | 样式    | -07     |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 4       | V1.3    | 更新封面页、页 | 2022-5- | 赵鹏 | 李鹤 | 崔湛   |
|         |         | 眉页脚样式及文 | 18 |       |         |         |
|         |         | 件密级  |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| 5       | A01     | 修改样式、添加 | 2024-07 | 闫博文 | 李鹤 | 张磊 |
|         |         | checkli | -24     |         |         |         |
|         |         | st；更新发布 |    |         |         |         |
|         |         | 范围：适用产研 |  |         |         |         |
|         |         | 平台。  |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
